<!doctype html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <!--  <analytics></analytics> -->
  </head>
  <body class="body-index">
    <section class="plug">
      <img class="line1" src="/src/images/line1.svg" alt="" />
      <img class="line2" src="/src/images/line2.svg" alt="" />
      <img class="line3" src="/src/images/line3.svg" alt="" />
      <img class="line4" src="/src/images/line4.svg" alt="" />
      <div class="container">
        <a class="plug__link" href="./about.html">о проекте</a>
        <div class="plug__text">
          <h1 class="plug__title">teatime</h1>
          <p class="plug__subtitle">Погрузись в мир чая</p>
        </div>
        <form id="my-form" action="https://formspree.io/f/mdojzwyp" method="POST" class="email">
          <label class="email__label" for="email">
            Узнай первым о запуске
            <div class="email__wrapper">
              <input
                class="email__input"
                id="email"
                name="email"
                type="email"
                placeholder="Ваш email"
              />
              <button id="my-form-button" class="email__button">OK</button>
            </div>
          </label>
          <p class="email__info" id="my-form-status"></p>
        </form>
      </div>
    </section>
    <script>
      var form = document.getElementById("my-form");
      
      async function handleSubmit(event) {
        event.preventDefault();
        var status = document.getElementById("my-form-status");
        var data = new FormData(event.target);
        fetch(event.target.action, {
          method: form.method,
          body: data,
          headers: {
              'Accept': 'application/json'
          }
        }).then(response => {
          if (response.ok) {
            status.innerHTML = "Спасибо за подписку!";
            form.reset()
          } else {
            response.json().then(data => {
              if (Object.hasOwn(data, 'errors')) {
                status.innerHTML = data["errors"].map(error => error["message"]).join(", ")
              } else {
                status.innerHTML = "Что-то пошло не так."
              }
            })
          }
        }).catch(error => {
          status.innerHTML = "Что-то пошло не так."
        });
      }
      form.addEventListener("submit", handleSubmit)
  </script>
  </body>
</html>
